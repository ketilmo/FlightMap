<!DOCTYPE html>
<html>
<html>
	<head>
		<title>GliderLog</title>
		<meta charset="utf-8" />
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" />
 		
 		<!--[if lte IE 8]>
     		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" />
 		<![endif]-->
 		
 		<style type="text/css">
 			body {
    			padding: 0;
			    margin: 0;
			}
			html, body, #map {
    			height: 100%;
			}
 		</style>
	</head>
	<body>
		<div id="map"></div>
		<script type="text/javascript" src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>
		<script src="/socket.io/socket.io.js"></script>

		<script type="text/javascript">


			var map = L.map('map').setView([60.3795075416565, 8.13684492111206], 8);
			L.tileLayer('http://opencache.statkart.no/gatekeeper/gk/gk.open_gmaps?layers=norges_grunnkart&zoom={z}&x={x}&y={y}', {
				maxZoom: 20,
				attribution: 'Map data &copy; <a href="http://www.kartverket.no/">Kartverket</a>, <a href="http://creativecommons.org/licenses/by/3.0/no/">CC-BY-NO</a>'
			}).addTo(map);

			var trackLayer = L.geoJson(null, { onEachFeature: onEachFeature }).addTo(map);


			var socket = io.connect();
			socket.on('trackData', function(trackData) {
				trackLayer.addData(trackData);
				map.fitBounds(trackLayer.getBounds());
				console.log(trackData);
			});

			function onEachFeature(feature, layer) {
    			if (feature.properties && feature.properties.popupContent) {
	        		layer.bindPopup(feature.properties.popupContent);
	    		}
			}

	
		</script>
	</body>
</html>
